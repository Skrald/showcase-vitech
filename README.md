# showcase-vitech

## SQL-1
> Нового сотрудника попросили подготовить данные для отчета руководству, но данные были подготовлены в неправильной форме.  
Требуется посредством SQL привести таблицу из исходного к правильному формату.
 
Данные были подготовлены в следующем виде:  

<img src=https://github.com/Skrald/showcase-vitech/blob/bbe86a9fc732ad05417dd3abcabff34fb1575b9c/images/sql-1-1.png width=196 height=225>

```sql
CREATE TABLE #measure_history (
	month_code		INT,
	measure_name	VARCHAR(20),
	measure_value	Decimal(18,4)
);
```

```sql
INSERT INTO #measure_history (month_code, measure_name, measure_value) VALUES
	(202305,'quantity', 100),
	(202305,'sale',   12312440.00 ),
	(202305,'margin', 2462488.00),
	(202305,'client', 10),
	(202306,'quantity', 110),
	(202306,'sale', 13814557.68),
	(202306,'margin', 2762911.536),
	(202306,'client', 15),
	(202307,'quantity', 135),
	(202307,'sale', 17293314.4776),
	(202307,'margin', 3458662.8955),
	(202307,'client', 20),
	(202308,'quantity', 150),
	(202308,'sale', 19599089.74),
	(202308,'margin', 3919817.95),
	(202308,'client',25);
```

Итоговая форма должна была быть:  

<img src=https://github.com/Skrald/showcase-vitech/blob/bbe86a9fc732ad05417dd3abcabff34fb1575b9c/images/sql-1-2.png width=289 height=83>

Описание:  

- quantity – кол-во реализованного товара, 
- sale – сумма реализованного товара, 
- margin – маржа реализованного товара, 
- client – кол-во клиентов купивших товар

Требования:  

a)	Предоставить решение как с использованием «group by», так и через pivot  
b)	Дополнительно вывести столбец с месячным приростом продаж  
> Решение в файле [sql-1](https://raw.githubusercontent.com/Skrald/showcase-vitech/main/sql-scripts/sql-1.sql)  

Дополнительно ответить на вопросы:  
a)	Какова динамика изменения маржинальности?  
> Маржинальность остаётся неизменной (20% выручки) - этот показатель отвязан от масштаба как при сравнении удельных показателей выручки / прибыли, так и тоталов по ним  

b)	Имеет ли место быть инфляция? Если да, то переложил ли ее продавец на конечного покупателя?  
> Однозначно можно делать вывод о постоянном влиянии внешнего ценового фактора (про инфляцию можно говорить при доп.вводных, например, динамике закупок / прямой себестоимости).  
Бремя этого фактора продавец переложил на конечного покупателя, так как его доля прибыли не изменилась. 

## SQL-2

## SQL-3

## Проверка навыков POWER BI

